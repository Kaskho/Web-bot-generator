<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Meme Coin Code Generator</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ¸ Meme Coin Code Generator</h1>
    <form id="genForm" enctype="multipart/form-data">
      <label>Coin Name:</label>
      <input type="text" name="coin_name" placeholder="NEXTPEPE" required>

      <label>Ticker:</label>
      <input type="text" name="ticker" placeholder="NPEPE" required>

      <label>Network:</label>
      <input type="text" name="network" value="Pump.fun">

      <label>Narrative:</label>
      <textarea name="narrative" rows="8" placeholder="Describe your meme coin story..." required></textarea>

      <label>Upload Media:</label>
      <input type="file" name="file" accept="image/*,video/*">

      <label>X (Twitter):</label>
      <input type="url" name="x_url" value="https://x.com/">

      <label>Telegram:</label>
      <input type="url" name="telegram_url" value="https://t.me/">

      <label>Pump.fun:</label>
      <input type="url" name="pump_fun" value="https://pump.fun/">

      <div class="buttons">
        <button id="previewBtn">ğŸ‘ Preview Website</button>
        <button id="generateBtn">ğŸš€ Download ZIP</button>
      </div>
    </form>
    <p id="status"></p>
  </div>

  <script>
  const form = document.getElementById("genForm");
  const previewBtn = document.getElementById("previewBtn");
  const genBtn = document.getElementById("generateBtn");
  const status = document.getElementById("status");

  previewBtn.addEventListener("click", async e => {
    e.preventDefault();
    status.innerText = "â³ Generating preview...";
    const data = new FormData(form);
    const res = await fetch("/preview", { method: "POST", body: data });
    if (!res.ok) { status.innerText = "âŒ Error generating preview."; return; }
    const html = await res.text();
    const win = window.open("", "_blank");
    win.document.write(html);
    win.document.close();
    status.innerText = "âœ… Preview opened in new tab.";
  });

  genBtn.addEventListener("click", async e => {
    e.preventDefault();
    status.innerText = "â³ Generating ZIP...";
    const data = new FormData(form);
    const res = await fetch("/generate", { method: "POST", body: data });
    if (!res.ok) { status.innerText = "âŒ Error generating project."; return; }
    const blob = await res.blob();
    const a = document.createElement("a");
    a.href = window.URL.createObjectURL(blob);
    a.download = data.get("coin_name") + "_project.zip";
    a.click();
    status.innerText = "âœ… ZIP downloaded!";
  });
  </script>
</body>
</html>
